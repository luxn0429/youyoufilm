package com.film.searchengine;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.baobao.utils.MD5;
import com.film.dao.bean.VolumeBean;
import com.film.dao.factory.DaoFactory;
import com.film.util.EscapeUnescape;
import com.film.util.ConstantUtil.PLATFORM;

public class Test {
	public static  Map<Integer,List<VolumeBean>> parseVideVolumn(String volumn,int video){
		String volumnStr = EscapeUnescape.unescape(volumn);
		int start = volumnStr.indexOf("'");
		int end = volumnStr.lastIndexOf("'");
		if(start>=0)
			volumnStr = volumnStr.substring(start+1, end);
		Map<Integer,List<VolumeBean>> result = new HashMap<Integer,List<VolumeBean>>();
		String[] platform = volumnStr.split("\\$\\$\\$");
		for(String p:platform){
			///平台与集的对应
			
			String[] p2v = p.split("\\$\\$");
			if(p2v.length <=1){
				p2v = p.split("\\$");
			}
			int playerPlat = 0;
			if(p2v[0].contains("百度")||p.contains("$bdhd")){
				playerPlat = PLATFORM.BAIDU.getIndex();
			}else if(p2v[0].contains("优酷") || p.contains("$youku")){
				playerPlat = PLATFORM.YOUKU.getIndex();
			}else if(p2v[0].contains("土豆") || p2v[0].contains("$tudou")){
				playerPlat = PLATFORM.TUDOU.getIndex();
			}else if(p2v[0].toLowerCase().contains("$qvod")){
				playerPlat = PLATFORM.QVOD.getIndex();
			}
			List<VolumeBean> list = result.get(playerPlat);
			if(null == list){
				list = new ArrayList<VolumeBean>();
				result.put(playerPlat,list);
			}
			String[] contents = p2v[1].split("#");
			for(String content:contents){
				String[] temp = content.split("\\$");
				VolumeBean bean = new VolumeBean();
				String url = content.substring(temp[0].length()+1);
				bean.setBelongto(video);
				bean.setPlayer(playerPlat);
				bean.setUrl(url);
				bean.setVolume(temp[0]);
				bean.setMd5(MD5.StringToMd5String(bean.getUrl()));
				/*////如果视频存在则不更新
				if(DaoFactory.getInstance().getVolumeDAO().exist(video, bean.getMd5()))
					continue;*/
				list.add(bean);
			}
		}
		return result;
	}
	/**
	 * @param args
	 */
	public static void main(String[] args) {
		String video = "var VideoInfoList=unescape('%u767E%u5EA6%u5F71%u97F3%24%24%u7B2C01%u96C6%24bdhd%3A//31110534%7C525B27C1498D24AAAFD5F9B329755656%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_01.rmvb%24bdhd%23%u7B2C02%u96C6%24bdhd%3A//31325178%7C8010565DB2D8654FFF897712F5B65FA1%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_02.rmvb%24bdhd%23%u7B2C03%u96C6%24bdhd%3A//31201629%7CC035643BE5FB7148AFA7ADB8CDEB4FDD%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_03.rmvb%24bdhd%23%u7B2C04%u96C6%24bdhd%3A//31605796%7C4DBE8521EAB697EA53AABD5AEA7E8E15%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_04.rmvb%24bdhd%23%u7B2C05%u96C6%24bdhd%3A//31064884%7C83DFBEA83009711F31D00983E12AA1EF%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_05.rmvb%24bdhd%23%u7B2C06%u96C6%24bdhd%3A//31153885%7C9075BE242287B54FFCE04658D033A55E%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_06.rmvb%24bdhd%23%u7B2C07%u96C6%24bdhd%3A//30837219%7C732DBF52748556632FEE9AD1665DC852%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_07.rmvb%24bdhd%23%u7B2C08%u96C6%24bdhd%3A//31364256%7CAA18A78A8F466FD1AC1C1F22747ED7ED%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_08.rmvb%24bdhd%23%u7B2C09%u96C6%24bdhd%3A//31067675%7C255A27348369288E6120803300F62987%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_09.rmvb%24bdhd%23%u7B2C10%u96C6%24bdhd%3A//32143182%7C8904591B4BFE2447DCCDB86464A0FA5C%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_10.rmvb%24bdhd%23%u7B2C11%u96C6%24bdhd%3A//33090184%7C08DE0C99FAD98EBE4C90DD8C81A29A45%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_11.rmvb%24bdhd%23%u7B2C12%u96C6%24bdhd%3A//31177316%7C3468059379CAF1EF02A56467BAC2BE54%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_12.rmvb%24bdhd%23%u7B2C13%u96C6%24bdhd%3A//31391464%7CB78D9E74A3D61E305C31EE039E6DC1E2%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_13.rmvb%24bdhd%23%u7B2C14%u96C6%24bdhd%3A//31831649%7CA9A10CCB1B0A61997C4EB8CE0F8CDC97%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_14.rmvb%24bdhd%23%u7B2C15%u96C6%24bdhd%3A//34397616%7C9EB1BA558F9341D0ED544F2B14F55F95%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_15.rmvb%24bdhd%23%u7B2C16%u96C6%24bdhd%3A//32649707%7C02879A098C1BA01D8A086BFCE6FFB3F9%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_16.rmvb%24bdhd%23%u7B2C17%u96C6%24bdhd%3A//32932300%7C96E69BEBDAC0063EAA05A1C21BF04A56%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_17.rmvb%24bdhd%23%u7B2C18%u96C6%24bdhd%3A//34092107%7C112C996D35693FF09B4CFF21E8A002C9%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_18.rmvb%24bdhd%23%u7B2C19%u96C6%24bdhd%3A//33665098%7C6B317EA3CBB2722DCA52821C56FF248C%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_19.rmvb%24bdhd%23%u7B2C20%u96C6%24bdhd%3A//35580010%7C2D350599DB241AA93D3A3D31A86E4823%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_20.rmvb%24bdhd%23%u7B2C21%u96C6%24bdhd%3A//33692818%7CAD0CFE66436C3EF496648C30A66406EC%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_21.rmvb%24bdhd%23%u7B2C22%u96C6%24bdhd%3A//32676341%7CF9161C711E851FA87F4DD53DEDAE359F%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_22.rmvb%24bdhd%23%u7B2C23%u96C6%24bdhd%3A//31590043%7C2781DAB5457B87405352A555BBA7D834%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_23.rmvb%24bdhd%23%u7B2C24%u96C6%24bdhd%3A//31290612%7CB80EBAFC5FB71C9726044A26B040E4B7%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_24.rmvb%24bdhd%23%u7B2C25%u96C6%24bdhd%3A//31385052%7C7421ABDA19B0DC976C327335DB21B4DD%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_25.rmvb%24bdhd%23%u7B2C26%u96C6%24bdhd%3A//32989753%7C676D9F90861F25E255BDF847C39B5B3C%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_26.rmvb%24bdhd%23%u7B2C27%u96C6%24bdhd%3A//32456234%7CBA4AFC251CCAE22F005A2FBB79532AFC%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_27.rmvb%24bdhd%23%u7B2C28%u96C6%24bdhd%3A//32239782%7CFE3927550BAB6958C9C7C86634901B9C%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_28.rmvb%24bdhd%23%u7B2C29%u96C6%24bdhd%3A//31417460%7CDDB699CDB5B14BC14A6131CD4264934F%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_29.rmvb%24bdhd%23%u7B2C30%u96C6%24bdhd%3A//31705828%7CC3009FC99C95E18F88F5A8B48C658E5E%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_30.rmvb%24bdhd%23%u7B2C31%u96C6%24bdhd%3A//31219424%7C8C631AD3BC8D63926D784002C1AAC54B%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_31.rmvb%24bdhd%23%u7B2C32%u96C6%24bdhd%3A//31079179%7C0663694657EB551B5FBC3BC56A39D0EC%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_32.rmvb%24bdhd%23%u7B2C33%u96C6%24bdhd%3A//80889650%7C740032348E3835667763B89E602DDDB6%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_33.rmvb%24bdhd%23%u7B2C34%u96C6%24bdhd%3A//81311647%7CAEC4BA12186A4B797B9ED1E5049FEB21%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_34.rmvb%24bdhd%23%u7B2C35%u96C6%24bdhd%3A//31299237%7C69BA1170F0A43823E8BB747BD05B8B80%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_35.rmvb%24bdhd%23%u7B2C36%u96C6%24bdhd%3A//34151294%7C1B9763369E7092C01DDE863EBB31BD7B%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_36.rmvb%24bdhd%23%u7B2C37%u96C6%24bdhd%3A//31350824%7CC7A753347471AB28A711706A2E90B75B%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_37.rmvb%24bdhd%23%u7B2C38%u96C6%24bdhd%3A//31255167%7CD0EF305D8D8FEB020EF6EDA8F4378418%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_38.rmvb%24bdhd%23%u7B2C39%u96C6%24bdhd%3A//31204563%7C5E305CE865B416B9CE8917028DDFCD68%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_39.rmvb%24bdhd%23%u7B2C40%u96C6%24bdhd%3A//31034944%7C19696167185658ACC2A344C4260D0A24%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_40.rmvb%24bdhd%23%u7B2C41%u96C6%24bdhd%3A//31314947%7C7D0058BFBD3E2D0C2FEFA409A23ED85A%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_41.rmvb%24bdhd%23%u7B2C42%u96C6%24bdhd%3A//30932618%7CFF302BC8B0C54C7895E3ACC0E0405CAE%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_42.rmvb%24bdhd%23%u7B2C43%u96C6%24bdhd%3A//30813455%7C681BC3159916BB22A599EE08E5623128%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_43.rmvb%24bdhd%23%u7B2C44%u96C6%24bdhd%3A//31965997%7C47725875D2BECC7A5658EC5B3E81D79E%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_44.rmvb%24bdhd%23%u7B2C45%u96C6%24bdhd%3A//31535538%7CAE6AF16C52A6E1C48701AF539CF65178%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_45.rmvb%24bdhd%23%u7B2C46%u96C6%24bdhd%3A//32805463%7C400E18FC0E2A40E60DC39102150EA9A2%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_46.rmvb%24bdhd%23%u7B2C47%u96C6%24bdhd%3A//31759578%7C92E4FA1DA33C4C22A2C1118CC11AE1D1%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_47.rmvb%24bdhd%23%u7B2C48%u96C6%24bdhd%3A//31561556%7C361D8392D0658A6DDC1FC678846772B3%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_48.rmvb%24bdhd%23%u7B2C49%u96C6%24bdhd%3A//31754017%7C36388C76BAD1D586DA5D9063BBA57D25%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_49.rmvb%24bdhd%23%u7B2C50%u96C6%24bdhd%3A//31202087%7C9965FC623306A8811288D7242D2025A6%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_50.rmvb%24bdhd%23%u7B2C51%u96C6%24bdhd%3A//15756890%7C9D35427ACF481877698DEB83B9EB91B0%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_51.rmvb%24bdhd%23%u7B2C52%u96C6%24bdhd%3A//17370811%7CC82B31E843E68F4F6208864CDA691A3E%7C%u6570%u7801%u5B9D%u8D1D%u7B2C%u4E09%u90E8_52.rmvb%24bdhd%24%24%24%u4F18%u9177%24%24%u7B2C1%u96C6%2413930534%24youku%23%u7B2C2%u96C6%2413930522%24youku%23%u7B2C3%u96C6%2413930511%24youku%23%u7B2C4%u96C6%2413930506%24youku%23%u7B2C5%u96C6%2413930496%24youku%23%u7B2C6%u96C6%2413930485%24youku%23%u7B2C7%u96C6%2413930477%24youku%23%u7B2C8%u96C6%2413930473%24youku%23%u7B2C9%u96C6%2413930469%24youku%23%u7B2C10%u96C6%2413930463%24youku%23%u7B2C11%u96C6%2413930454%24youku%23%u7B2C12%u96C6%2413930449%24youku%23%u7B2C13%u96C6%2413930439%24youku%23%u7B2C14%u96C6%2413930432%24youku%23%u7B2C15%u96C6%2413930426%24youku%23%u7B2C16%u96C6%2413930415%24youku%23%u7B2C17%u96C6%2413930406%24youku%23%u7B2C18%u96C6%2413930403%24youku%23%u7B2C19%u96C6%2413930397%24youku%23%u7B2C20%u96C6%2413930390%24youku%23%u7B2C21%u96C6%2413930384%24youku%23%u7B2C22%u96C6%2413930378%24youku%23%u7B2C23%u96C6%2413930367%24youku%23%u7B2C24%u96C6%2413930358%24youku%23%u7B2C25%u96C6%2413930352%24youku%23%u7B2C26%u96C6%2413930342%24youku%23%u7B2C27%u96C6%2413930340%24youku%23%u7B2C28%u96C6%2413930336%24youku%23%u7B2C29%u96C6%2413930330%24youku%23%u7B2C30%u96C6%2413930326%24youku%23%u7B2C31%u96C6%2413930315%24youku%23%u7B2C32%u96C6%2413930308%24youku%23%u7B2C33%u96C6%2413930301%24youku%23%u7B2C34%u96C6%2413930296%24youku%23%u7B2C35%u96C6%2413930291%24youku%23%u7B2C36%u96C6%2413930288%24youku%23%u7B2C37%u96C6%2413930284%24youku%23%u7B2C38%u96C6%2413930274%24youku%23%u7B2C39%u96C6%2413930266%24youku%23%u7B2C40%u96C6%2413930254%24youku%23%u7B2C41%u96C6%2413930248%24youku%23%u7B2C42%u96C6%2413930243%24youku%23%u7B2C43%u96C6%2413930239%24youku%23%u7B2C44%u96C6%2413930232%24youku%23%u7B2C45%u96C6%2413930226%24youku%23%u7B2C46%u96C6%2413930220%24youku%23%u7B2C47%u96C6%2413930203%24youku%23%u7B2C48%u96C6%2413930196%24youku%23%u7B2C49%u96C6%2413930184%24youku%23%u7B2C50%u96C6%2413930156%24youku%23%u7B2C51%u96C6%2413930179%24youku%23%u7B2C52%u96C6%2413930135%24youku')";
		Test.parseVideVolumn(video, 1);
	}

}
